import unittest
import array_distance


class BruteForceArrayDistanceTest(unittest.TestCase):
    def test_simple(self):
        dist = array_distance.array_distance_brute_force_no_optimization_whatsoever([1], [2])
        self.assertEqual((0, 0, 1), dist)

    def test_simple_further(self):
        dist = array_distance.array_distance_brute_force_no_optimization_whatsoever([1], [6])
        self.assertEqual((0, 0, 5), dist)

    def test_with_negatives(self):
        dist = array_distance.array_distance_brute_force_no_optimization_whatsoever([16, 10, -6, -12],
                                                                                    [-10, -2, 4, 14, 20])
        self.assertEqual((0, 3, 2), dist)

    def test_midsize_array(self):
        asc_array = [-99426, -97922, -92573, -91983, -90028, -89736, -89079, -88593, -87451, -86274, -85412, -82114,
                     -82017, -75391, -70109, -69618, -67514, -65268, -62768, -60304, -59208, -57133, -56493, -53686,
                     -53059, -52498, -49174, -48501, -45016, -41643, -41104, -39552, -39470, -38776, -36736, -33362,
                     -32782, -31369, -22019, -20720, -19742, -18241, -17450, -16863, -15987, -13216, -9630, -6795,
                     -6141, -5048, -4001, -1380, -1138, -911, 354, 2867, 3457, 8700, 9663, 15217, 21627, 21789, 22760,
                     27700, 32268, 34938, 38532, 39811, 40219, 41583, 42168, 44050, 44464, 46652, 49980, 51714, 52488,
                     57947, 58115, 59107, 59482, 59785, 62334, 63671, 66786, 68886, 77812, 83147, 83211, 84078, 84830,
                     87257, 89218, 93222, 94047, 94673, 97904, 99499, 99776]
        dsc_array = [98181, 97666, 97036, 96786, 95990, 95152, 90882, 90365, 89289, 88532, 87811, 87585, 85535, 82369,
                     81435, 80586, 75229, 70940, 69754, 69485, 67853, 67460, 65907, 61134, 57282, 56142, 53284, 50634,
                     45807, 42218, 39831, 37901, 34353, 33049, 30047, 26160, 24756, 22243, 22002, 21324, 18886, 17287,
                     15142, 9570, 8895, 5844, 1533, 1073, -1744, -1998, -4062, -4946, -6563, -13113, -16050, -16274,
                     -22638, -24193, -26498, -26708, -27670, -33119, -39314, -39605, -39652, -41279, -45840, -48042,
                     -49143, -49346, -50029, -51772, -54368, -54847, -60945, -63864, -65718, -66507, -69492, -69582,
                     -70208, -70452, -75144, -76817, -77706, -78110, -78767, -79503, -79629, -82712, -83701, -83940,
                     -85500, -89175, -89231, -89751, -96503, -97276, -98169]
        res = array_distance.array_distance_brute_force_no_optimization_whatsoever(asc_array, dsc_array)
        self.assertEqual((5, 95, 15), res)


class BinarySearchArrayDistanceTest(unittest.TestCase):
    def test_simple(self):
        dist = array_distance.array_distance_with_search([1], [2])
        self.assertEqual((0, 0, 1), dist)

    def test_simple_further(self):
        dist = array_distance.array_distance_with_search([1], [6])
        self.assertEqual((0, 0, 5), dist)

    def test_with_negatives(self):
        dist = array_distance.array_distance_with_search([16, 10, -6, -12],
                                                                                    [-10, -2, 4, 14, 20])
        self.assertEqual((0, 3, 2), dist)

    def test_midsize_array(self):
        asc_array = [-99426, -97922, -92573, -91983, -90028, -89736, -89079, -88593, -87451, -86274, -85412, -82114,
                     -82017, -75391, -70109, -69618, -67514, -65268, -62768, -60304, -59208, -57133, -56493, -53686,
                     -53059, -52498, -49174, -48501, -45016, -41643, -41104, -39552, -39470, -38776, -36736, -33362,
                     -32782, -31369, -22019, -20720, -19742, -18241, -17450, -16863, -15987, -13216, -9630, -6795,
                     -6141, -5048, -4001, -1380, -1138, -911, 354, 2867, 3457, 8700, 9663, 15217, 21627, 21789, 22760,
                     27700, 32268, 34938, 38532, 39811, 40219, 41583, 42168, 44050, 44464, 46652, 49980, 51714, 52488,
                     57947, 58115, 59107, 59482, 59785, 62334, 63671, 66786, 68886, 77812, 83147, 83211, 84078, 84830,
                     87257, 89218, 93222, 94047, 94673, 97904, 99499, 99776]
        dsc_array = [98181, 97666, 97036, 96786, 95990, 95152, 90882, 90365, 89289, 88532, 87811, 87585, 85535, 82369,
                     81435, 80586, 75229, 70940, 69754, 69485, 67853, 67460, 65907, 61134, 57282, 56142, 53284, 50634,
                     45807, 42218, 39831, 37901, 34353, 33049, 30047, 26160, 24756, 22243, 22002, 21324, 18886, 17287,
                     15142, 9570, 8895, 5844, 1533, 1073, -1744, -1998, -4062, -4946, -6563, -13113, -16050, -16274,
                     -22638, -24193, -26498, -26708, -27670, -33119, -39314, -39605, -39652, -41279, -45840, -48042,
                     -49143, -49346, -50029, -51772, -54368, -54847, -60945, -63864, -65718, -66507, -69492, -69582,
                     -70208, -70452, -75144, -76817, -77706, -78110, -78767, -79503, -79629, -82712, -83701, -83940,
                     -85500, -89175, -89231, -89751, -96503, -97276, -98169]
        res = array_distance.array_distance_with_search(asc_array, dsc_array)
        self.assertEqual((5, 95, 15), res)


if __name__ == '__main__':
    unittest.main()
